## Unique IDs

React does not provide native means to ensure generation of unique IDs to use with HTML input components. This means
that making dynamically generated IDs for label `htmlFor` and input `id` attributes needs a lot of thinking to get it
right, especially when making universally rendering applications and both server generated HTML and client generated DOM
should have the same IDs.

React Maria solves this problem by providing a HOC `withUniqueId` method:

```jsx
import { withUniqueId } from 'react-maria'

function MyComponent({ id }) {
    return <div id={id}>My ID: {id}</div>
}

export default withUniqueId({ identifier: 'my-component' })(MyComponent)
```

With this code in place your component will receive two new props: `id` and `uniqueId`. The first one can be used
directly with one element and is guaranteed to have a unique ID that has a running number added after the defined
`identifier`.

You can render this component as many times as you want: React Maria guards things in the background to ensure there are
no duplicate IDs - as long as you use the provided API to generate the IDs! And there is more API than just `id`:

```jsx
function MyComponent({ id, uniqueId }) {
    const uid = uniqueId()

    return <div id={id}>My ID: {id} and my another ID: {uid.next()}</div>
}
```

In render you can do `const uid = uniqueId()` to start generating more sub-IDs for the current `uniqueId`, thus
allowing more than one element to have unique ID within the same render. The returned `uid` has three methods: `next()`,
`last()` and `make()`:

- `next()` generates a new unique ID and returns it.
- `last()` returns the latest ID generated by `next()`.
- `make()` takes an array or object and returns similar array or object with uniquefied IDs.

You can also give additional identifier to next and last: `uid.next('car')` will generate id `my-component1.car1` upon
first call. Likewise, `uid.last('car')` will return this same ID.

**Call `uniqueId()` only once, only in a component's render and do NOT pass it further to the subtree!** This
will cause issues and a danger of duplicate IDs. You may however pass the result from `uniqueId()` to other
components as a prop during your component's render.

### Unique IDs in the server side

Right after (or right before) rendering static HTML in server side you must call `clearUniqueIds`: otherwise server and
client generated IDs will get unsynced.

```js
import ReactDOMServer from 'react-dom/server'
import { clearUniqueIds } from 'react-maria'

export function getHtml(app) {
    const html = ReactDOMServer.renderToStaticMarkup(app)
    // clean up generated IDs so we are ready for the next round
    clearUniqueIds()
    return html
}
```

### Why Maria implements unique IDs?

React does not provide anything for this issue, see [RFC #32: isomorphic IDs](https://github.com/reactjs/rfcs/pull/32).
There are other solutions to this problem, but...

**... they have no universal render**:

- [`react-id-decorator`](https://www.npmjs.com/package/react-id-decorator)
- [`react-sequential-id`](https://www.npmjs.com/package/react-sequential-id)
- [`react-stable-uniqueid`](https://www.npmjs.com/package/react-stable-uniqueid)
- [`react-uniqueid`](https://www.npmjs.com/package/react-uniqueid)
- [`@team-griffin/react-unique-id`](https://www.npmjs.com/package/@team-griffin/react-unique-id)

**... or they mutate your component like a mixin (antipattern)**:

- [`react-html-id`](https://www.npmjs.com/package/react-html-id)

**... or they have no documentation at all**:

- [`@xo-union/react-unique-id`](https://www.npmjs.com/package/@xo-union/react-unique-id)

And the remaining solutions that can be found have clearly not spent time to think about the problem or the
implementation is based on outdated React features (like mixins).